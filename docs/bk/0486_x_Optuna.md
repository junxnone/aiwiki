-----

| Title     | x Optuna                                              |
| --------- | ----------------------------------------------------- |
| Created @ | `2024-10-16T08:36:29Z`                                |
| Updated @ | `2024-10-17T02:35:21Z`                                |
| Labels    | \`\`                                                  |
| Edit @    | [here](https://github.com/junxnone/aiwiki/issues/486) |

-----

# Optuna

  - è¶…å‚æ•°ä¼˜åŒ–
  - optuna-dashboard å¯ä»¥è¯»å–å­˜å‚¨çš„æ•°æ®ç”¨æ¥æ˜¾ç¤º
      - æ”¯æŒ web/vscode/jupyter
  - ä¼˜åŒ–åœæ­¢æœºåˆ¶
  - Trail æ—©åœæœºåˆ¶
  - è¶…å‚é‡‡æ ·å™¨

## Samplers

  - ç”¨äºåœ¨è¶…å‚æ•°æœç´¢ç©ºé—´ä¸­ç”Ÿæˆå‚æ•°å€¼çš„å»ºè®®ã€‚

| é‡‡æ ·å™¨åç§°                                                                 | å·¥ä½œåŸç†                           | ä¼˜åŠ¿                            | åŠ£åŠ¿                      | é€‚ç”¨åœºæ™¯                     |
| --------------------------------------------------------------------- | ------------------------------ | ----------------------------- | ----------------------- | ------------------------ |
| RandomSamplerï¼ˆéšæœºé‡‡æ ·å™¨ï¼‰                                                  | å®Œå…¨éšæœºç”Ÿæˆå‚æ•°å€¼                      | ç®€å•ç›´æ¥ï¼Œå¯ç”¨äºå¿«é€Ÿæ¢ç´¢å¤§æœç´¢ç©ºé—´ï¼Œæ— å…ˆéªŒçŸ¥è¯†æ—¶å¯ä½œä¸ºåŸºå‡† | ç¼ºä¹å¼•å¯¼æ€§ï¼Œæ‰¾åˆ°è¾ƒä¼˜è§£å¯èƒ½éœ€è¦å¤§é‡è¯•éªŒ     | å¯¹æœç´¢ç©ºé—´æ¯«æ— å¤´ç»ªæ—¶è¿›è¡Œåˆæ­¥æ¢ç´¢ï¼Œæˆ–ä½œä¸ºç®€å•å¯¹ç…§ |
| GridSamplerï¼ˆç½‘æ ¼é‡‡æ ·å™¨ï¼‰                                                    | æŒ‰ç…§é¢„è®¾çš„ç½‘æ ¼éå†æ‰€æœ‰å¯èƒ½çš„å‚æ•°ç»„åˆ             | ç¡®ä¿å…¨é¢è¦†ç›–æœç´¢ç©ºé—´ï¼Œå¯¹äºå°å‚æ•°ç©ºé—´èƒ½è¿›è¡Œå½»åº•æ¢ç´¢     | åœ¨é«˜ç»´åº¦æˆ–å¤§è§„æ¨¡æœç´¢ç©ºé—´ä¸­æ•ˆç‡æä½ï¼Œè®¡ç®—æˆæœ¬é«˜ | å‚æ•°ç©ºé—´å°ä¸”èƒ½æ˜ç¡®åˆ’åˆ†çš„æƒ…å†µ           |
| TPESamplerï¼ˆTree-structured Parzen Estimator Samplerï¼‰                  | åŸºäºå†å²è¯•éªŒæ„å»ºæ¦‚ç‡æ¨¡å‹ï¼Œåˆ’åˆ†æœç´¢ç©ºé—´å¹¶åœ¨æœ‰å¸Œæœ›åŒºåŸŸå¯†é›†é‡‡æ · | å¯¹å¤æ‚æœç´¢ç©ºé—´é€‚åº”æ€§å¼ºï¼Œé«˜ç»´åº¦æƒ…å†µè¡¨ç°è‰¯å¥½ï¼Œæœ‰ä¸€å®šå¼•å¯¼æ€§  | å¯¹äºç®€å•æœç´¢ç©ºé—´å¯èƒ½ç›¸å¯¹å¤æ‚          | å¤æ‚æœç´¢ç©ºé—´ï¼Œå°¤å…¶æ˜¯é«˜ç»´åº¦é—®é¢˜          |
| CmaEsSamplerï¼ˆCovariance Matrix Adaptation Evolution Strategy Samplerï¼‰ | åˆ©ç”¨åæ–¹å·®çŸ©é˜µè°ƒæ•´æœç´¢æ–¹å‘å’Œæ­¥é•¿ï¼ŒåŸºäºè¿›åŒ–ç­–ç•¥ç®—æ³•      | åœ¨è¿ç»­å‚æ•°ç©ºé—´ä¸”å¤æ‚éçº¿æ€§å…³ç³»é—®é¢˜ä¸­å¯èƒ½æœ‰è¾ƒå¥½è¡¨ç°     | è®¡ç®—èµ„æºéœ€æ±‚å¤§ï¼Œæ—¶é—´å¤æ‚åº¦é«˜          | è¿ç»­å‚æ•°ç©ºé—´çš„å¤æ‚ä¼˜åŒ–é—®é¢˜            |
| NSGAIISamplerï¼ˆå¤šç›®æ ‡ä¼˜åŒ–çš„å¸¦ç²¾è‹±ç­–ç•¥éæ”¯é…æ’åºé—ä¼ ç®—æ³•é‡‡æ ·å™¨ï¼‰                                | åŸºäºé—ä¼ ç®—æ³•è¿›è¡Œå¤šç›®æ ‡ä¼˜åŒ–                  | é€‚ç”¨äºå¤šç›®æ ‡ä¼˜åŒ–åœºæ™¯ï¼Œèƒ½æ‰¾åˆ°ä¸€ç»„éæ”¯é…è§£          | å•ç›®æ ‡ä¼˜åŒ–æ—¶å¯èƒ½ä¸å¦‚ä¸“é—¨çš„å•ç›®æ ‡é‡‡æ ·å™¨é«˜æ•ˆ   | å¤šç›®æ ‡ä¼˜åŒ–é—®é¢˜                  |
| QMCSamplerï¼ˆQuasi-Monte Carlo Samplerï¼‰                                 | ä½¿ç”¨å‡†è’™ç‰¹å¡ç½—æ–¹æ³•è¿›è¡Œé‡‡æ ·                  | èƒ½æ›´å‡åŒ€åœ°è¦†ç›–æœç´¢ç©ºé—´ï¼Œé€‚åˆéœ€è¦å‡åŒ€é‡‡æ ·çš„åœºæ™¯       | å¯èƒ½åœ¨æŸäº›æƒ…å†µä¸‹ä¸å¦‚å…¶ä»–é‡‡æ ·å™¨å¿«é€Ÿæ‰¾åˆ°æœ€ä¼˜è§£  | å¯¹æœç´¢ç©ºé—´å‡åŒ€æ€§è¦æ±‚é«˜çš„åœºæ™¯           |
| GPSampler                                                             | å…·ä½“åŸç†å› å®ç°è€Œå¼‚ï¼Œå¯èƒ½æœ‰ç‰¹å®šä¼˜åŒ–ç­–ç•¥            | åœ¨ç‰¹å®šåœºæ™¯ä¸‹å¯èƒ½æœ‰è¾ƒå¥½è¡¨ç°                 | é€‚ç”¨èŒƒå›´ç›¸å¯¹è¾ƒçª„                | ç‰¹å®šä¼˜åŒ–é—®é¢˜                   |
| BoTorchSampler                                                        | å¯èƒ½ç»“åˆäº† BoTorch åº“çš„ç‰¹å®šä¼˜åŒ–ç­–ç•¥         | å¯¹äºç‰¹å®šé—®é¢˜å¯èƒ½æä¾›æ›´é«˜æ•ˆçš„é‡‡æ ·              | é€‚ç”¨åœºæ™¯è¾ƒä¸ºå±€é™                | ä¸ BoTorch åº“ç›¸å…³çš„ç‰¹å®šä¼˜åŒ–åœºæ™¯     |
| BruteForceSamplerï¼ˆæš´åŠ›æœç´¢é‡‡æ ·å™¨ï¼‰                                            | é€šè¿‡æš´åŠ›æœç´¢éå†æ‰€æœ‰å¯èƒ½çš„å‚æ•°ç»„åˆ              | ç†è®ºä¸Šèƒ½ç¡®ä¿æ‰¾åˆ°å…¨å±€æœ€ä¼˜è§£ï¼ˆå¦‚æœè®¡ç®—èµ„æºå…è®¸ï¼‰       | è®¡ç®—èµ„æºæ¶ˆè€—å·¨å¤§ï¼Œä»…é€‚ç”¨äºæå°çš„å‚æ•°ç©ºé—´    | å‚æ•°ç©ºé—´éå¸¸å°ä¸”å¿…é¡»ç¡®ä¿å®Œå…¨è¦†ç›–çš„æƒ…å†µ      |

| ç‰¹æ€§          | RandomSampler | GridSampler | TPESampler    | CmaEsSampler    | NSGAIISampler  | QMCSampler | GPSampler | BoTorchSampler | BruteForceSampler |
| ----------- | ------------- | ----------- | ------------- | --------------- | -------------- | ---------- | --------- | -------------- | ----------------- |
| æµ®ç‚¹æ•°å‚æ•°       | âœ“             | âœ“           | âœ“             | âœ“               | â–´              | âœ“          | âœ“         | âœ“              | âœ“                 |
| æ•´æ•°å‚æ•°        | âœ“             | âœ“           | âœ“             | âœ“               | â–´              | âœ“          | âœ“         | â–´              | âœ“                 |
| åˆ†ç±»å‚æ•°        | âœ“             | âœ“           | âœ“             | â–´               | âœ“              | â–´          | âœ“         | â–´              | âœ“                 |
| å‰ªæ          | âœ“             | âœ“           | âœ“             | â–´               | Ã—              | âœ“          | â–´         | â–´              | âœ“                 |
| å¤šå˜é‡ä¼˜åŒ–       | â–´             | â–´           | âœ“             | âœ“               | â–´              | â–´          | âœ“         | âœ“              | â–´                 |
| æ¡ä»¶æœç´¢ç©ºé—´      | âœ“             | â–´           | âœ“             | â–´               | â–´              | â–´          | â–´         | â–´              | âœ“                 |
| å¤šç›®æ ‡ä¼˜åŒ–       | âœ“             | âœ“           | âœ“             | Ã—               | âœ“ï¼ˆå•ç›®æ ‡ä¸ºâ–´ï¼‰       | âœ“          | Ã—         | âœ“              | âœ“                 |
| æ‰¹é‡ä¼˜åŒ–        | âœ“             | âœ“           | âœ“             | âœ“               | âœ“              | âœ“          | â–´         | âœ“              | âœ“                 |
| åˆ†å¸ƒå¼ä¼˜åŒ–       | âœ“             | âœ“           | âœ“             | âœ“               | âœ“              | âœ“          | â–´         | âœ“              | âœ“                 |
| çº¦æŸä¼˜åŒ–        | Ã—             | Ã—           | âœ“             | Ã—               | âœ“              | Ã—          | Ã—         | Ã—              | Ã—                 |
| æ—¶é—´å¤æ‚åº¦ï¼ˆæ¯æ¬¡è¯•éªŒï¼‰ | ğ‘‚(ğ‘‘)          | ğ‘‚(ğ‘‘ğ‘›)       | ğ‘‚(ğ‘‘ğ‘› logâ¡ğ‘›)   | ğ‘‚(ğ‘‘Â³)           | ğ‘‚(ğ‘šğ‘Â²)         | ğ‘‚(ğ‘‘ğ‘›)      | ğ‘‚(ğ‘›Â³)     | ğ‘‚(ğ‘›Â³)          | ğ‘‚(ğ‘‘)              |
| æ¨èè¯•éªŒæ¬¡æ•°      | æŒ‰éœ€çµæ´»è®¾ç½®        | å–å†³äºå‚æ•°ç»„åˆæ•°    | 100 - 1000 å·¦å³ | 1000 - 10000 å·¦å³ | 100 - 10000 å·¦å³ | æŒ‰éœ€çµæ´»è®¾ç½®     | \-500     | 10 - 100 å·¦å³    | å–å†³äºå‚æ•°ç»„åˆæ•°          |

> âœ“ : Supports this feature. â–´: Works, but inefficiently. Ã— : Causes an
> error, or has no interface.

## Pruner

  - ç”¨äºæå‰åœæ­¢æ²¡æœ‰å¸Œæœ›çš„è¯•éªŒï¼Œä»¥èŠ‚çœè®¡ç®—èµ„æºå’Œæ—¶é—´ã€‚

| å‰ªæå™¨åç§°                   | å·¥ä½œåŸç†                                                   | é€‚ç”¨åœºæ™¯                              |
| ----------------------- | ------------------------------------------------------ | --------------------------------- |
| MedianPruner            | é€šè¿‡æ¯”è¾ƒè¯•éªŒçš„ä¸­é—´ç»“æœä¸å·²å®Œæˆè¯•éªŒçš„ä¸­é—´ç»“æœçš„ä¸­ä½æ•°æ¥å†³å®šæ˜¯å¦æå‰åœæ­¢è¯•éªŒã€‚                 | é€‚ç”¨äºå¤§å¤šæ•°ä¼˜åŒ–é—®é¢˜ï¼Œç›®æ ‡å‡½æ•°æ³¢åŠ¨ä¸å¤§ï¼Œå¸Œæœ›è¾ƒå¿«æ‰¾åˆ°è¾ƒå¥½è§£å†³æ–¹æ¡ˆã€‚ |
| NopPruner               | ä¸è¿›è¡Œä»»ä½•å‰ªææ“ä½œï¼Œæ‰€æœ‰è¯•éªŒéƒ½ä¼šä¸€ç›´è¿è¡Œåˆ°å®Œæˆã€‚                               | ä¸ç¡®å®šæ˜¯å¦éœ€è¦å‰ªææˆ–æƒ³å¯¹æ‰€æœ‰è¯•éªŒè¿›è¡Œå®Œæ•´è¿è¡Œä»¥è¿›è¡Œåˆ†æã€‚      |
| SuccessiveHalvingPruner | åŸºäº Successive Halving ç®—æ³•é€æ­¥å‡å°‘æ­£åœ¨è¿è¡Œçš„è¯•éªŒæ•°é‡ï¼Œå°†èµ„æºé›†ä¸­åœ¨è¡¨ç°è¾ƒå¥½çš„è¯•éªŒä¸Šã€‚  | å¤§è§„æ¨¡è¶…å‚æ•°æœç´¢é—®é¢˜ï¼Œè®¡ç®—èµ„æºæœ‰é™éœ€å¿«é€Ÿæ‰¾åˆ°è¾ƒå¥½è§£å†³æ–¹æ¡ˆã€‚     |
| HyperbandPruner         | ç»“åˆ Successive Halving ç®—æ³•å’Œéšæœºæœç´¢æ€æƒ³ï¼Œåœ¨ä¸åŒèµ„æºçº§åˆ«ä¸Šè¿›è¡Œè¯•éªŒå¹¶åŠ¨æ€è°ƒæ•´èµ„æºåˆ†é…ã€‚ | å¤æ‚ä¼˜åŒ–é—®é¢˜å’Œå¤§è§„æ¨¡è¶…å‚æ•°æœç´¢ï¼Œèƒ½åœ¨è¾ƒçŸ­æ—¶é—´å†…æ‰¾åˆ°é«˜è´¨é‡è§£å†³æ–¹æ¡ˆã€‚ |
| ThresholdPruner         | æ ¹æ®ç”¨æˆ·è®¾å®šçš„é˜ˆå€¼æ¥è¿›è¡Œå‰ªæï¼Œè‹¥è¯•éªŒä¸­é—´ç»“æœè¶…è¿‡é˜ˆå€¼åˆ™åœæ­¢è¯•éªŒã€‚                       | å¯¹ç›®æ ‡å‡½æ•°æœ‰å…ˆéªŒçŸ¥è¯†ï¼ŒçŸ¥é“åˆç†é˜ˆå€¼æ—¶ä½¿ç”¨ã€‚             |

## Terminator

  - è‡ªåŠ¨ç»ˆæ­¢ä¼˜åŒ–è¿‡ç¨‹æ¨¡å—, å½“ä¼°è®¡çš„æ½œåœ¨æ”¹è¿›å°äºç»Ÿè®¡è¯¯å·®æ—¶ï¼Œç»ˆæ­¢ä¼˜åŒ–è¿‡ç¨‹ã€‚
  - åŒ…æ‹¬ç»ˆæ­¢å›è°ƒç±»å’Œç”¨äºè¯„ä¼°ä¼˜åŒ–æ”¹è¿›ç©ºé—´åŠç›®æ ‡å‡½æ•°ç»Ÿè®¡è¯¯å·®çš„è¯„ä¼°å™¨ã€‚

| ç±»å                                | æè¿°                  | åˆå§‹åŒ–å‚æ•°                                                                                                                    | æ–¹æ³•                                                    |
| --------------------------------- | ------------------- | ------------------------------------------------------------------------------------------------------------------------ | ----------------------------------------------------- |
| BaseTerminator                    | ç»ˆæ­¢å™¨çš„åŸºç±»              | æ—                                                                                                                         | should\_terminate(study)                              |
| Terminator                        | Optunaç ”ç©¶çš„è‡ªåŠ¨åœæ­¢æœºåˆ¶     | improvement\_evaluatorï¼ˆé»˜è®¤ä¸ºRegretBoundEvaluatorï¼‰ã€error\_evaluatorï¼ˆé»˜è®¤ä¸ºCrossValidationErrorEvaluatorï¼‰ã€min\_n\_trialsï¼ˆé»˜è®¤ä¸º20ï¼‰ | should\_terminate(study)                              |
| BaseImprovementEvaluator          | æ”¹è¿›è¯„ä¼°å™¨çš„åŸºç±»            | æ—                                                                                                                         | evaluate(trials, study\_direction)                    |
| RegretBoundEvaluator              | å¯¹é—æ†¾ä¸Šç•Œè¿›è¡Œè¯„ä¼°çš„è¯¯å·®è¯„ä¼°å™¨     | top\_trials\_ratioï¼ˆé»˜è®¤ä¸º0.5ï¼‰ã€min\_n\_trialsï¼ˆé»˜è®¤ä¸º20ï¼‰ç­‰                                                                        | evaluate(trials, study\_direction)                    |
| BestValueStagnationEvaluator      | è¯„ä¼°ä¼˜åŒ–è¿‡ç¨‹ä¸­æœ€ä½³å€¼çš„åœæ»æœŸ      | max\_stagnation\_trialsï¼ˆé»˜è®¤ä¸º30ï¼‰                                                                                           | evaluate(trials, study\_direction)                    |
| EMMREvaluator                     | è¯„ä¼°é¢„æœŸæœ€å°æ¨¡å‹é—æ†¾ï¼ˆEMMRï¼‰    | deterministic\_objectiveï¼ˆé»˜è®¤ä¸ºFalseï¼‰ã€deltaï¼ˆé»˜ä¸º0.1ï¼‰ç­‰                                                                         | evaluate(trials, study\_direction)                    |
| BaseErrorEvaluator                | è¯¯å·®è¯„ä¼°å™¨çš„åŸºç±»            | æ—                                                                                                                         | evaluate(trials, study\_direction)                    |
| CrossValidationErrorEvaluator     | åŸºäºäº¤å‰éªŒè¯è¯„ä¼°ç›®æ ‡å‡½æ•°çš„ç»Ÿè®¡è¯¯å·®   | æ—                                                                                                                         | evaluate(trials, study\_direction)ï¼Œè¿”å›ä¸€ä¸ªæµ®ç‚¹æ•°è¡¨ç¤ºç›®æ ‡å‡½æ•°çš„ç»Ÿè®¡è¯¯å·® |
| StaticErrorEvaluator              | æ€»æ˜¯è¿”å›ä¸€ä¸ªå¸¸é‡å€¼çš„è¯¯å·®è¯„ä¼°å™¨     | constantï¼ˆç”¨æˆ·æŒ‡å®šçš„å¸¸é‡å€¼ï¼‰                                                                                                       | evaluate(trials, study\_direction)                    |
| MedianErrorEvaluator              | è¿”å›ä¸åˆå§‹ä¸­ä½æ•°ä¹‹æ¯”çš„è¯¯å·®è¯„ä¼°å™¨    | paired\_improvement\_evaluatorã€warm\_up\_trialsï¼ˆé»˜è®¤ä¸º10ï¼‰ã€n\_initial\_trialsï¼ˆé»˜ä¸º20ï¼‰ã€threshold\_ratioï¼ˆé»˜ä¸º0.01ï¼‰                 | evaluate(trials, study\_direction)                    |
| TerminatorCallback                | ä½¿ç”¨Terminatorç»ˆæ­¢ä¼˜åŒ–çš„å›è°ƒ | terminatorï¼ˆé»˜è®¤ä¸ºå¸¦æœ‰é»˜è®¤improvement\_evaluatorå’Œerror\_evaluatorçš„Terminatorå¯¹è±¡ï¼‰                                                  | æ— ï¼ˆç”¨äºä¸optimize()æ–¹æ³•é…åˆï¼‰                                  |
| report\_cross\_validation\_scores | æŠ¥å‘Šè¯•éªŒäº¤å‰éªŒè¯åˆ†æ•°çš„å‡½æ•°       | trialã€scores                                                                                                             | æ— ï¼ˆåœ¨ç›®æ ‡å‡½æ•°å†…è°ƒç”¨ï¼Œç”¨äºæä¾›æ•°æ®ç»™è¯„ä¼°å™¨åˆ¤æ–­æ˜¯å¦ç»ˆæ­¢ï¼‰                          |

## Reference

  - [optuna](https://optuna.org/)
  - [optuna docs](https://optuna.readthedocs.io/)
