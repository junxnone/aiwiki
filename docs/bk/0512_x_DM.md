-----

| Title     | x DM                                                  |
| --------- | ----------------------------------------------------- |
| Created @ | `2025-04-14T03:34:25Z`                                |
| Updated @ | `2025-04-14T09:01:27Z`                                |
| Labels    | \`\`                                                  |
| Edit @    | [here](https://github.com/junxnone/aiwiki/issues/512) |

-----

# Diffusion Model

  - 扩散模型是一种生成模型，主要用于图像生成和其他计算机视觉任务。基于扩散的神经网络经过深度学习训练，逐渐利用随机噪声“扩散”样本，然后反向操作该扩散过程以生成高质量图像。

## 来源: 非平衡热力学中的扩散现象

  - 扩散模型的灵感源自物理学 - 非平衡热力学中的扩散现象

> \[\!NOTE\]  
> 以一滴墨水在水中扩散为例，在墨水扩散前，其在水中的分布是复杂的，难以用简单的数学公式描述和采样。但随着墨水逐渐扩散，水分子将分布得更简单、更均匀，此时可以用简单的数学公式来描述其概率分布。
> 在图像生成中，类似地，将复杂的图像数据通过逐步添加噪声，使其最终变为简单的噪声分布，这个过程就像墨水在水中扩散，从难以描述的复杂分布转化为易于处理的简单分布。

> Sohl-Dickstein 等人 在 2015 年的论文《Deep Unsupervised Learning using
> Nonequilibrium Thermodynamics》中首次引入了灵感源自物理学的扩散模型。他们的算法应用了 [Langevin
> 动力学](https://en.wikipedia.org/wiki/Langevin_dynamics)（一种对分子系统运动进行建模的方法）来支撑扩散模型的基本前提：将数据转化为噪声，以便将噪声转化为数据。

## 原理

  - 在训练过程中，扩散模型利用随机噪声逐步扩散数据点，直到数据点被破坏，然后学习反向操作扩散过程，重建原始数据分布。然后，经过训练的扩散模型可以仅通过对纯噪声的随机初始样本去噪，生成类似于训练数据的新数据点。
    
      - 前向扩散过程，是指将训练数据集中的图像转换为纯噪声 – 通常是高斯分布。
      - 反向扩散过程，是指模型学习执行原始前向扩散过程中每个先前步长的反向过程。
      - 图像生成，是指经过训练的模型对随机噪声分布进行采样，并使用学习的反向扩散过程将其转换为高质量输出，以对高斯噪声的随机样本进行去噪。

### 前向扩散过程

  - 前向扩散过程的目的是将训练数据集中的干净数据（例如图像或音频样本）转换为纯噪声。最常见的方法是迭代注入高斯噪声，直到整个数据分布都是高斯分布。

> \[\!NOTE\] 在每个时间步长 t，向 xt-1
> 添加少量高斯噪声，然后重新缩放图像以保持恒定图像大小，但会不断注入随机像素。在此公式中，x0
> 是原始的干净数据点；x1 是第一个时间步长后的数据点，其中添加了少量高斯噪声；xT 是前向扩散过程的最终状态。如果 T
> 足够大，即经过足够多的步长后，xT 将变为纯高斯噪声。

### 反向扩散过程

> \[\!NOTE}
> 在扩散模型中，反向扩散过程才是真正的机器学习过程。在学习执行前向过程的噪声逐步的反向操作时，该模型本质上是学习将纯高斯噪声去噪为干净的图像。神经网络经过训练后，即可利用这种能力通过逐步反向扩散从高斯噪声中生成新图像。

> 预测 $x\_t$ 中存在的整个噪声，然后去除该噪声的一部分（基于该步长方差时间表的状态），以得出 $x\_{t-1}$ 。

## LDM

  - Latent Diffusion Model 潜在扩散模型/隐式扩散模型
  - 该模型能够不在高维像素空间中应用扩散过程（即直接应用于输入图像），而是先将输入投影到低维[隐式空间](https://www.ibm.com/cn-zh/think/topics/variational-autoencoder)，然后在该空间中应用扩散过程。
  - 减少计算成本，加快速度
  - 潜在扩散模型采用类似 VAE 的自动编码器架构来训练编码器输出输入数据 x 的潜在表示
    z。然后将这些潜在表示用作标准扩散模型的输入，通常使用
    U-Net 架构。由于扩散模型处理的是低维数据，因此会将输出输入解码器网络，对所需最终图像大小进行上采样。
  - 
## Reference

  - [什么是扩散模型？--
    IBM](https://www.ibm.com/cn-zh/think/topics/diffusion-models)
