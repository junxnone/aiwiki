-----

| Title     | paper DualAnoDiff cn                                  |
| --------- | ----------------------------------------------------- |
| Created @ | `2025-06-10T02:42:05Z`                                |
| Updated @ | `2025-06-10T02:55:50Z`                                |
| Labels    | \`\`                                                  |
| Edit @    | [here](https://github.com/junxnone/aiwiki/issues/523) |

-----

# DualAnoDiff CN

**Dual-Interrelated Diffusion Model for Few-Shot Anomaly Image
Generation**

    Ying Jin1∗, Jinlong Peng2*, Qingdong He2∗, Teng Hu3, Jiafu Wu2, Hao Chen1
    Haoxuan Wang1, Wenbing Zhu1, Mingmin Chi1†
    , Jun Liu2, Yabiao Wang2,4†
    1Fudan University, 2Youtu Lab, Tencent, 3Shanghai Jiao Tong University, 4Zhejiang University
    {yjin22, haochen22, hxwang23, wbzhu23}@m.fudan.edu.cn, mmchi@fudan.edu.cn
    {jeromepeng, yingcaihe, jiafwu, juliusliu}@tencent.com, hu-teng@sjtu.edu.cn, yabiaowang@zju.edu.cn

**<https://github.com/yinyjin/DualAnoDiff>**

## 摘要

工业制造中的异常检测性能受到异常数据稀缺的限制。为了克服这一挑战，研究人员已开始采用异常生成方法来扩充异常数据集。然而，现有异常生成方法存在生成异常的多样性有限、难以实现异常与原始图像的无缝融合等问题。此外，生成的掩码通常与生成的异常区域不匹配。在本文中，我们从新的视角克服了这些挑战，同时生成了一对整体图像和相应的异常部分。我们提出了**DualAnoDiff**，这是一种新型的基于扩散模型的小样本异常图像生成模型，该模型通过**使用两个相互关联的扩散模型来生成多样化且逼真的异常图像，其中一个模型用于生成整体图像，另一个用于生成异常部分。此外，我们提取背景和形状信息，以缓解小样本图像生成中的扭曲和模糊现象**。大量实验表明，我们提出的模型在多样性、真实性和掩码准确性方面优于最先进的方法。总体而言，我们的方法显著提高了下游异常检测任务的性能，包括异常检测、异常定位和异常分类任务。代码将公开提供。

## 1 简介

工业异常检测（即异常检测、定位与分类）在工业制造中具有重要作用\[6\]。然而，在实际工业生产中，异常样本极为稀缺。因此，当前**主流的异常检测方法要么是仅使用正常样本的无监督方法\[22,36\]，要么是同时利用正常样本和少量异常数据的半监督方法**\[48\]。尽管这些方法在异常检测任务中表现出色，但在异常定位方面性能有限，且无法处理异常分类任务\[14\]。为此，研究人员提出了异常生成方法，通过生成更多异常数据，以借助有监督的异常检测实现更优性能。

现有异常生成方法可分为两类：

  - 1）**无模型方法从现有异常或异常纹理数据集中随机裁剪补丁并粘贴到正常样本上\[20,23,46\]，但其合成的异常数据缺乏真实感**；
  - 2）**生成式方法采用生成对抗网络（GAN）和扩散模型等生成模型来生成异常数据**。

通常，基于GAN的模型\[26,47\]需要大量训练数据才能实现较好的生成性能，且无法生成掩码。DFMGAN\[6\]先在正常数据上训练，再迁移到异常数据以实现小样本生成，但该方法因**缺乏显式对齐约束设计，存在生成异常真实感不足\[29\]和掩码对齐不精准\[21\]的问题**。基于扩散模型\[33\]纹理反演技术\[7\]的AnomalyDiffusion\[14\]，分别学习异常外观和位置信息，再在掩码后的正常样本上生成异常。由于该方法仅关注异常部分，**生成的异常与原图融合不自然，且单独生成的掩码可能出现在图像背景区域**。

为解决上述局限，我们提出DualAnoDiff——一种新型小样本异常图像生成模型，通过双关联扩散机制同步生成整体图像与对应异常部分。该方法可**实现异常图像与异常部分的有效融合，生成具有高真实感、精准对齐且多样性良好的异常图像-掩码数据对**。具体而言，**模型基于预训练扩散模型，引入两个LoRA\[12\]将单一扩散模型扩展为双关联扩散架构**：

  - **全局分支**
    负责生成整体异常图像，**异常分支**生成局部异常区域，两者通过**自注意力交互模块**交换信息。该模块融合双分支的注意力层并执行共享注意力计算，实现双去噪过程中的信息交互与融合，**确保生成的整体异常图像与局部异常区域的一致性**。
  - 为进一步保持背景不变性，引入基于自注意力自适应注入的**背景补偿模块**：对背景图像添加噪声后，从中间特征层提取键（Key）和值（Value），通过自适应融合MLP**将背景信息融入全局分支，从而维持生成图像中背景的准确性和物体形状的完整性**。
