---
Title | 相移法结构光3D重建
-- | --
Create Date | `2022-04-06T21:54:58Z`
Update Date | `2022-04-07T02:15:52Z`
Edit link | [here](https://github.com/junxnone/aiwiki/issues/309)

---
## Reference
- [结构光三维重建——相移法基本原理](https://zhuanlan.zhihu.com/p/106226749)
- [基于相移法的结构光三维测量技术](https://blog.csdn.net/qq_42676511/article/details/120605768)


## Brief
- 相移法 - `Phase Shifting Method`
- 相位测量轮廓术 - **PMP** - `Phase Measurement Profilometry`
- 通过投影一系列相移光栅图像编码获取物体表面的相对位置或绝对位置
- **缺点**
  - 投影仪存在Gamma 非线性关系, 结正弦结构光投影成像后不具备良好正弦性，需要非线性矫正相位误差
  - 环境光\噪声\阴影等造成的相位展开错误(可以通过 `+格雷码` 方式解决)
  - 传统相移机械移动的精度导致的相位误差(现在不存在)

## 相移计算
- N 张条纹图像总相移为 $2\pi$ , 每张图片相移量为 $\frac{2\pi}{N}$
- $I^{'}$ 为环境光强
- $I^{''}$ 为调制强度
- $\theta$ 为相位(**包裹相位**)
  - 如果 $\theta \in [-\pi,\pi]$, 则换算到 $[0, 2\pi]$ => $\theta = \theta + \pi$

相移公式 | $I_n = I^{'} + I^{''}cos(\theta + \frac{2n}{N}\pi)$
-- | --
$I_0$ | $I^{'} + I^{''}cos(\theta)$
$I_1$ |  $I^{'} + I^{''}cos(\theta + \frac{2}{N}\pi)$
... | 

### 绝对相位
- 使用格雷码获取相位周期($n_k$)
- $\Theta = \theta \pm 2n_k\pi$ 为**绝对相位**
- $n_{k+1}=\begin{cases} n_k+1 & \text{ if } \left| \theta_{k+1} - \theta_{k}\right|\geq \pi \\ n_k & \text{ if } \left| \theta_{k+1} - \theta_{k}\right| < \pi \end{cases}$

### 解码


解码公式 | $\theta = -tan^{-1}(\frac{\sum_{0}^{N-1}I_{n}sin(\frac{2n}{N}\pi)}{\sum_{0}^{N-1}I_{n}cos(\frac{2n}{N}\pi)})$
-- | --
N = 3 | $\theta = -tan^{-1}(\frac{\sum_{0}^{2}I_{n}sin(\frac{2n}{3}\pi)}{\sum_{0}^{2}I_{n}cos(\frac{2n}{3}\pi)})$
